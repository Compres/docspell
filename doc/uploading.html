<!DOCTYPE html><html><head><title>Docspell: Uploads</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="eikek" /><meta name="description" content="Auto-tagging Document Organizer" /><meta name="og:image" content="/img/poster.png" /><meta name="image" property="og:image" content="/img/poster.png" /><meta name="og:title" content="Docspell: Uploads" /><meta name="title" property="og:title" content="Docspell: Uploads" /><meta name="og:site_name" content="Docspell" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Auto-tagging Document Organizer" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="Docspell: Uploads" /><meta name="twitter:image" content="/img/poster.png" /><meta name="twitter:description" content="Auto-tagging Document Organizer" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon.png" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/vs.css" /><link rel="stylesheet" href="/css/light-style.css" /><link rel="stylesheet" href="/css/docspell.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><div id="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"></div><span>Docspell</span></a><button id="main-toggle" class="sidebar-toggle"><span class="close"></span></button></div><div class="sidebar-nav"> <div class="sidebar-nav-item  "><a href="/index.html" title="Home" class="">Home</a></div> <div class="sidebar-nav-item  "><a href="/demo.html" title="Demo" class="">Demo</a></div> <div class="sidebar-nav-item  "><a href="/getit" title="Quickstart" class="">Quickstart</a></div> <div class="sidebar-nav-item  "><a href="/features.html" title="Features/Limitations" class="">Features/Limitations</a></div> <div class="sidebar-nav-item  open"><a href="/doc.html" title="Documentation" class="drop-nested">Documentation</a><i class="fa fa-angle-right"></i><div class="sub-section"> <a href="/doc/install.html" title="Installation" class="">Installation</a> <a href="/doc/configure.html" title="Configuring" class="">Configuring</a> <a href="/doc/nix" title="Nix/NixOS" class="">Nix/NixOS</a> <a href="/doc/reverseproxy" title="Reverse Proxy" class="">Reverse Proxy</a> <a href="/doc/metadata.html" title="Adding Meta Data" class="">Adding Meta Data</a> <a href="/doc/uploading.html" title="Uploads" class="active">Uploads</a> <a href="/doc/processing.html" title="Processing Queue" class="">Processing Queue</a> <a href="/doc/curate.html" title="Find and Review" class="">Find and Review</a> <a href="/doc/mailitem.html" title="Send via E-Mail" class="">Send via E-Mail</a> <a href="/doc/joex.html" title="Joex" class="">Joex</a> <a href="/doc/tools.html" title="Tools" class="">Tools</a></div></div> <div class="sidebar-nav-item  "><a href="/changelog" title="Changelog" class="">Changelog</a></div> <div class="sidebar-nav-item  "><a href="/dev.html" title="Development" class="drop-nested">Development</a><i class="fa fa-angle-right"></i><div class="sub-section"> <a href="/dev/adr.html" title="" class=""></a></div></div> <div class="sidebar-nav-item  "><a href="/api.html" title="Api" class="drop-nested">Api</a><i class="fa fa-angle-right"></i><div class="sub-section"> <a href="/openapi/docspell-openapi.html" title="REST Api Doc" class="">REST Api Doc</a> <a href="/openapi/docspell-openapi.yml" title="REST OpenApi Spec" class="">REST OpenApi Spec</a></div></div></div></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/eikek/docspell" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/eikek/docspell" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="eikek" data-github-repo="docspell"><div class="content-wrapper"><section><h1 id="uploads">Uploads</h1>

<p>This page describes, how files can get into docspell. Technically,
there is just one way: via http multipart/form-data requests.</p>

<h2 id="authenticated-upload">Authenticated Upload</h2>

<p>From within the web application there is the “Upload Files”
page. There you can select multiple files to upload. You can also
specify whether these files should become one item or if every file is
a separate item.</p>

<p>When you click “Submit” the files are uploaded and stored in the
database. Then the job executor(s) are notified which immediately
start processing them.</p>

<p>Go to the top-right menu and click “Processing Queue” to see the
current state.</p>

<p>This obviously requires an authenticated user. While this is handy for
ad-hoc uploads, it is very inconvenient for automating it by custom
scripts. For this the next variant exists.</p>

<h2 id="anonymous-upload">Anonymous Upload</h2>

<p>It is also possible to upload files without authentication. This
should make tools that interact with docspell much easier to write.</p>

<h3 id="creating-anonymous-uploads">Creating Anonymous Uploads</h3>

<p>Go to “Collective Settings” and then to the “Source” tab. A <em>Source</em>
identifies an endpoint where files can be uploaded
anonymously. Creating a new source creates a long unique id which is
part on an url that can be used to upload files. You can choose any
time to deactivate or delete the source at which point uploading is
not possible anymore. The idea is to give this URL away safely. You
can delete it any time and no passwords or secrets are visible, even
your username is not visible.</p>

<p>Example screenshot:</p>

<div class="thumbnail">
  <img src="../img/sources-form.jpg" />
</div>

<p>This example shows a source with name “test”. It defines two urls:</p>

<ul>
  <li><code class="highlighter-rouge">/app/upload/&lt;id&gt;</code></li>
  <li><code class="highlighter-rouge">/api/v1/open/upload/item/&lt;id&gt;</code></li>
</ul>

<p>The first points to a web page where everyone could upload files into
your account. You could give this url to people for sending files
directly into your docspell.</p>

<p>The second url is the API url, which accepts the requests to upload
files (which is used by the first url).</p>

<p>For example, this url can be used to upload files with curl:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-XPOST</span> <span class="nt">-F</span> <span class="nv">file</span><span class="o">=</span>@test.pdf http://localhost:7880/api/v1/open/upload/item/CqpFTb7UmGe-9nMVPZSmnwc-AHH6nWFh52t-M1JFQ9y7cdH
<span class="o">{</span><span class="s2">"success"</span>:true,<span class="s2">"message"</span>:<span class="s2">"Files submitted."</span><span class="o">}</span>
</code></pre></div></div>

<p>You could add more <code class="highlighter-rouge">-F file=@/path/to/your/file.pdf</code> to upload
multiple files (note, the <code class="highlighter-rouge">@</code> is required by curl, so it knows that
the following is a file).</p>

<p>When files are uploaded to an source endpoint, the items resulting
from this uploads are marked with the name of the source. So you know
which source an item originated.</p>

<p>If files are uploaded using the web applications <em>Upload files</em> page,
the source is implicitly set to <code class="highlighter-rouge">webapp</code>. If you also want to let
docspell count the files uploaded through the web interface, just
create a source (can be inactive) with that name (<code class="highlighter-rouge">webapp</code>).</p>

<h2 id="the-request">The Request</h2>

<p>This gives more details about the request for uploads. It is a http
<code class="highlighter-rouge">multipart/form-data</code> request, with two possible fields:</p>

<ul>
  <li>meta</li>
  <li>file</li>
</ul>

<p>The <code class="highlighter-rouge">file</code> field can appear multiple times and is required at least
once. It is the part containing the file to upload.</p>

<p>The <code class="highlighter-rouge">meta</code> part is completely optional and can define additional meta
data, that docspell uses to create items from the given files. It
allows to transfer structured information together with the
unstructured binary files.</p>

<p>The <code class="highlighter-rouge">meta</code> content must be <code class="highlighter-rouge">application/json</code> containing this
structure:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ multiple: Bool
, direction: Maybe String
}
</code></pre></div></div>

<p>The <code class="highlighter-rouge">multiple</code> property is by default <code class="highlighter-rouge">true</code>. It means that each file
in the upload request corresponds to a single item. An upload with 5
files will result in 5 items created. If it is <code class="highlighter-rouge">false</code>, then docspell
will create just one item, that will then contain all files.</p>

<p>Furthermore, the direction of the document (one of <code class="highlighter-rouge">incoming</code> or
<code class="highlighter-rouge">outgoing</code>) can be given. It is optional, it can be left out or
<code class="highlighter-rouge">null</code>.</p>

<p>This kind of request is very common and most programming languages
have support for this. For example, here is another curl command
uploading two files with meta data:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -XPOST -F meta='{"multiple":false, "direction": "outgoing"}' \
            -F file=@letter-en-source.pdf \
            -F file=@letter-de-source.pdf \
            http://localhost:7880/api/v1/open/upload/item/CqpFTb7UmGe-9nMVPZSmnwc-AHH6nWFh52t-M1JFQ9y7cdH
</code></pre></div></div>
</section><div class="edit-button"><a href="https://github.com/eikek/docspell/edit/master/modules/microsite/docs/doc/uploading.md" target="_blank" rel="noopener noreferrer" class="btn-sm btn-info">Improve this page</a></div></div></div></div></div><script src="/highlight/highlight.pack.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/json.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/javascript.min.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash','json','javascript']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script src="/js/docs.js"></script></body></html>